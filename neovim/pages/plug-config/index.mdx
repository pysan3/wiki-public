---
title: Enhance Your Nvim Life With Plugins!
date: 2022-09-12
tags: ["neovim", "nvim", "setup", "Japanese", "ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—"]
type: docs
description: Walk though how to setup packer.nvim to manage your plugins [../00-plug-config]
spoiler: 
---

# Enhance Your Nvim Life With Plugins!

Nvimã¯ã¨ã¦ã‚‚å¤šãã®æ‹¡å¼µæ©Ÿèƒ½ãŒé–‹ç™ºã•ã‚Œã¦ãŠã‚Šã€ãã‚Œã‚’ç®¡ç†ã™ã‚‹ã®ã‚‚éå¸¸ã«ç°¡å˜ã§ã™ã€‚

Nvimã®çœŸé«„ã‚’å‘³ã‚ã†ãŸã‚ã«ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å…¥ã‚Œã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ã‚‡ã†ã€‚

## Split Your Config File into Separate Files

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ç®¡ç†ã‚’ã—å§‹ã‚ã‚‹ã¨ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®è¡Œæ•°ãŒå¢—ãˆã¦ã„ãç®¡ç†ãŒã—ã¥ã‚‰ããªã£ã¦ã—ã¾ã„ã¾ã™ã€‚
ãã®ãŸã‚ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¤‡æ•°ã«åˆ†ã‘ãã‚Œãã‚Œã®è¨­å®šã‚’ã©ã“ã«æ›¸ã„ãŸã‹è¦‹ã¤ã‘ã‚„ã™ãã—ã¾ã—ã‚‡ã†ã€‚

ãã‚Œã‚‰ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ `init.vim` / `init.lua` ã‹ã‚‰importã—ã¦ã„ãã¾ã™ã€‚

### How to Import Separate Files

Importã®ä»•æ–¹ã¯è¨€èªã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ã€‚
`vimscript`ã‚’importã™ã‚‹ã«ã¯`source <file-name>`ã‚’ã—ã€`lua`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’importã™ã‚‹ã«ã¯`require("<file-name>")`ã‚’ã—ã¾ã™ã€‚luaã®å ´åˆã¯ `~/.config/nvim/lua/` ãŒãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ã‚¹ã«ãªã£ã¦ã„ã¦ã€ãã“ã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹ã‚’requireã—ã¾ã™ã€‚

ä»®ã«ã“ã†ã„ã†ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã«ãªã£ã¦ã„ãŸã¨ã™ã‚‹ã¨ã€
```txt
ğŸ“‚ ~/.config/nvim
â”œâ”€â”€ ğŸ“‚ general
â”‚  â””â”€â”€ ğŸ‡» settings.vim
â”œâ”€â”€ ğŸ“‚ lua
â”‚  â””â”€â”€ ğŸ“‚ 00-general
â”‚     â””â”€â”€ ğŸŒ‘ settings.lua
â”œâ”€â”€ ğŸŒ‘ init.lua
â””â”€â”€ ğŸ‡» init.vim
```

- `init.vim` -> vimscript files, lua files

```vimscript filename="init.vim"
" import vimscript file
source ~/.config/nvim/general/settings.vim
" import lua files
lua require('00-general.settings')
```

- `init.lua` -> vimscript files, lua files

```lua filename="init.lua"
-- import vimscript file
vim.cmd([[
source ~/.config/nvim/general/settings.vim
]])
-- import lua files (one of the followings)
require('00-general.settings')
require('00-general/settings') -- requireã®ãƒ‘ã‚¹ã¯/ã‹.ã§éšå±¤ã‚’åŒºåˆ‡ã‚‹ (.ãŒä¸€èˆ¬çš„)
require '00-general.settings' -- ã‹ã£ã“ã¯çœç•¥å¯èƒ½
require "00-general.settings" -- æ–‡å­—åˆ—ã¯ "" ã‚‚ã‚ã‚Š
```

# Packer.nvim

ä»Šå›ã¯ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ã¨ã—ã¦ [`packer.nvim`](https://github.com/wbthomason/packer.nvim) ã«ã¤ã„ã¦æ›¸ãã¾ã™ã€‚ã»ã‹ã«ã‚‚ã„ã‚ã„ã‚ã‚ã£ã¦ã€ã©ã‚Œã‚‚åŸºæœ¬çš„ã«ä½¿ã„å‹æ‰‹ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚

- [packer.nvim](https://github.com/wbthomason/packer.nvim) : Luaã§æ›¸ã‹ã‚Œã¦ã„ã¦é€Ÿã„ã€‚ã¿ã‚“ãªä½¿ã£ã¦ã‚‹
- [dein.vim](https://github.com/Shougo/dein.vim) : ä½œè€…ãŒæ—¥æœ¬äººãªã®ã§æ—¥æœ¬èªã®è¨˜äº‹å¤šã‚
- [vim-plug](https://github.com/junegunn/vim-plug) : å¤ãã‹ã‚‰ã‚ã‚‹ã®ã§ã©ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã‚‚ã“ã‚ŒãŒè¼‰ã£ã¦ã‚‹ã“ã¨ãŒå¤šã„

åŸºæœ¬çš„ãªä½¿ã„æ–¹ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã€ã“ã‚Œã‚’è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚³ãƒ”ãƒšã—ã¦ãã ã•ã„ã€‚ãŸã ã—ã€ã“ã®è¨˜äº‹ã§ã¯è¨­å®šã‚’æ›¸ãã‚„ã™ãã™ã‚‹ãŸã‚ã«ã¡ã‚‡ã£ã¨æ›¸ãæ–¹ã‚’å¤‰ãˆã¾ã™ã€‚ãã®ã¾ã¾ã“ã®è¨˜äº‹ã«å¾“ã£ã¦ã„ãå ´åˆã¯ [## Automatically Install Packer.nvim](#automaticaly-install-packernvim) ã¾ã§ã‚¹ã‚­ãƒƒãƒ—ã€‚

[Option Details](https://github.com/wbthomason/packer.nvim#specifying-plugins)
```lua
vim.cmd [[packadd packer.nvim]]

return require('packer').startup(function(use)
  -- Packer can manage itself
  use 'wbthomason/packer.nvim'

  -- Simple plugins can be specified as strings
  use 'lunarvim/colorschemes'
  use 'folke/tokyonight.nvim'

  -- Post-install/update hook with neovim command
  use { 'nvim-treesitter/nvim-treesitter', run = ':TSUpdate' }
end)
```

## Automatically Install Packer.nvim

Packer.nvimã«é–¢ã™ã‚‹è¨­å®šã‚’æ›¸ããƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã—ã¾ã™ã€‚ `~/.config/nvim/lua/00-plug-config/init.lua` ã‚’ä½œã£ã¦ãã ã•ã„ã€‚
Packer.nvimã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯åˆ¥é€”ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã§ã™ãŒã€ãã‚Œã‚’è‡ªå‹•çš„ã«è¡Œãªã£ã¦ãã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æœ€åˆã«æ›¸ãã¾ã™ã€‚

ã¾ãŸã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®èª­ã¿è¾¼ã¿ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ `~/.config/nvim/plugin/packer_compiled.lua` ã«ä½œæˆã—ã¾ã™ã€‚ã“ã‚ŒãŒdotfilesã‚’æ±šã—ã¦ã—ã¾ã†ã®ã§ä½œæˆå…ˆã‚’å¤‰æ›´ã—ã¦ã„ã¾ã™ã€‚

```lua
local install_path = vim.fn.stdpath("data") .. "/site/pack/packer/start/packer.nvim"
if vim.fn.empty(vim.fn.glob(install_path)) > 0 then
  local git_path = "https://github.com/wbthomason/packer.nvim"
  PACKER_BOOTSTRAP = vim.fn.system({ "git", "clone", "--depth", "1", git_path, install_path })
  print("Installing packer close and reopen Neovim...")
  vim.cmd([[packadd packer.nvim]])
end
local compile_path = string.format("%s/%s", vim.fn.stdpath("cache"), "plugin/packer_compiled.lua")
local packer = require("packer")

packer.reset()
packer.init({
  compile_path = compile_path,
  display = { open_fn = require("packer.util").float },
  autoremove = true,
})
if vim.fn.filereadable(compile_path) ~= 0 then
  vim.cmd(string.format("luafile %s", compile_path))
end
```

## Manage Multiple Plugins

ç®¡ç†ã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®æ•°ãŒå¤šããªã£ã¦ãã‚‹ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã®æ•°ãŒè†¨å¤§ã«ãªã£ã¦ã—ã¾ã†ã®ã§ã€æ©Ÿèƒ½åˆ¥ã§ãƒ•ã‚©ãƒ«ãƒ€ã«åˆ†ã‘ã¾ã™ã€‚ã“ã®è¨˜äº‹ã‚‚ãã®ãƒ•ã‚©ãƒ«ãƒ€ã”ã¨ã«ç« ã‚’åˆ†ã‘ã¦æ›¸ã„ã¦ã„ã¾ã™ã€‚

æœ€çµ‚çš„ãªãƒ•ã‚©ãƒ«ãƒ€ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã¯ã“ã‚“ãªæ„Ÿã˜ã«ãªã‚Šã¾ã™ã€‚ãã‚Œãã‚Œè§£èª¬ã™ã‚‹ãƒšãƒ¼ã‚¸ãŒã‚ã‚‹ã®ã§èˆˆå‘³ãŒã‚ã‚‹ã‚‚ã®ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚

```txt
~/.config/nvim/lua/
â”œâ”€â”€ 00-plug-config/ <- ï½²ï¾ï½ºï½º
â”œâ”€â”€ 10-color-config/
â”œâ”€â”€ 10-ts-config/
â”œâ”€â”€ 11-uiline-config/
â”œâ”€â”€ 20-register-config/
â”œâ”€â”€ 20-utility-config/
â”œâ”€â”€ 25-telescope-config/
â”œâ”€â”€ 30-git-config/
â”œâ”€â”€ 40-terminal-config/
â”œâ”€â”€ 50-command-config/
â”œâ”€â”€ 50-operations-config/
â”œâ”€â”€ 60-lang-config/
â”œâ”€â”€ 70-cmp-config/
â”œâ”€â”€ 70-lsp-config/
â””â”€â”€ 80-debug-config/
```

ãã‚Œãã‚Œã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’é †ç•ªã«èª­ã¿è¾¼ã‚“ã§ã„ãã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ãã¾ã™ã€‚ã“ã‚Œã‚’é †ç•ªã«èª­ã¿è¾¼ã‚€ã‚³ãƒ¼ãƒ‰ã‚’`~/.config/nvim/lua/00-plug-config/init.lua` ã«è¿½è¨˜ã—ã¦ãã ã•ã„ã€‚

```lua
return packer.startup(function(use)
  -- stylua: ignore start
  local function load_sub_dirs(dir_name)
    local load_ok, plugin_table = pcall(require, dir_name)
    if not load_ok then return false end
    for _, plugin in ipairs(plugin_table.install or {}) do use(plugin) end
    for _, plugin in ipairs(plugin_table.setup or {}) do
      if type(plugin) ~= "table" then plugin = { plugin } end
      plugin.config = string.format([[require("%s.%s")]], dir_name, plugin[1]:gsub(".*/([^.]*)%.?.*$", "%1"))
      use(plugin)
    end
  end

  -- stylua: ignore end

  use({ "lewis6991/impatient.nvim" })
  require("impatient")

  use({ "wbthomason/packer.nvim" }) -- Have packer manage itself
  use({ "nvim-lua/popup.nvim" }) -- An implementation of the Popup API from vim in Neovim
  use({ "nvim-lua/plenary.nvim" }) -- Useful lua functions used lots of plugins

  -- ä»Šã¯å…¨éƒ¨ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
  -- load_sub_dirs("10-color-config")
  -- load_sub_dirs("10-ts-config")
  -- load_sub_dirs("11-uiline-config")
  -- load_sub_dirs("20-utility-config")
  -- load_sub_dirs("20-register-config")
  -- load_sub_dirs("25-telescope-config")
  -- load_sub_dirs("30-git-config")
  -- load_sub_dirs("40-terminal-config")
  -- load_sub_dirs("50-operations-config")
  -- load_sub_dirs("50-command-config")
  -- load_sub_dirs("60-lang-config")
  -- load_sub_dirs("70-cmp-config")
  -- load_sub_dirs("70-lsp-config")
  -- load_sub_dirs("80-debug-config")

  if PACKER_BOOTSTRAP then
    packer.sync()
  end
end)
```

`impatient.nvim` ~ `plenary.nvim`ã¯å¿…é ˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãªã®ã§ã™ã§ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã—ã¾ã„ã¾ã—ã‚‡ã†ã€‚

`init.vim` or `init.lua`ã§ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚ã¡ãªã¿ã«`init.lua`ã¯pythonã§ã„ã†`__init__.py`ã¨åŒã˜æ„å‘³ã§ã€ãƒ•ã‚©ãƒ«ãƒ€åã ã‘requireã™ã‚Œã°ã„ã„ã§ã™ã€‚

```vimscript filename="init.vim"
lua require '00-plug-config'
```

```lua filename="init.lua"
require("00-plug-config")
```

ã„ã£ãŸã‚“Nvimã‚’é–‰ã˜ã¦ã€å†åº¦é–‹ã„ã¦ãã ã•ã„ã€‚ãã“ã§`:PackerSync<CR>`ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨`impatient.nvim` ~ `plenary.nvim`ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå§‹ã¾ã‚‹ã¯ãšã§ã™ã€‚

***

<span style={{ textAlign: "center" }}>
ç„¡äº‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ãŸã‚‰ã€[æ¬¡å›](10-color-config)ã¯colorscheme (è‰²ã®è¨­å®š) ã‚’ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚
</span>

***
